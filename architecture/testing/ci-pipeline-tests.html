<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> - StockEase Architecture Documentation</title>
    <link rel="stylesheet" href="/stockease/templates/enterprise-docs.css">
</head>
<body>
    <header>
        <div class="header-content">
            <a href="/stockease/index.html" class="logo">üìö StockEase Architecture Docs</a>
            <nav class="nav-breadcrumb">
                <a href="/stockease/index.html">Home</a> / <span id="breadcrumb">Documentation</span>
            </nav>
        </div>
    </header>

    <div class="container">
        <aside id="sidebar"></aside>
        <main>
            <div class="content">
                <h1 id="ci-pipeline-tests">CI Pipeline Tests</h1>
                <p><strong>Purpose</strong>: Document how tests are
                executed in GitHub Actions CI/CD pipeline and what gates
                prevent merge failures.</p>
                <hr />
                <h2 id="table-of-contents">Table of Contents</h2>
                <ol type="1">
                <li><a href="#ci-pipeline-overview">CI Pipeline
                Overview</a></li>
                <li><a href="#test-execution-stages">Test Execution
                Stages</a></li>
                <li><a href="#quality-gates">Quality Gates</a></li>
                <li><a href="#failure-handling">Failure
                Handling</a></li>
                <li><a href="#artifacts--reports">Artifacts &amp;
                Reports</a></li>
                <li><a href="#related-documentation">Related
                Documentation</a></li>
                </ol>
                <hr />
                <h2 id="ci-pipeline-overview">CI Pipeline Overview</h2>
                <h3 id="current-setup-proposed">Current Setup
                (Proposed)</h3>
                <p><strong>File</strong>:
                <code>.github/workflows/ci-build.yml</code></p>
                <pre><code>Push to main/PR
    ‚Üì
Checkout code
    ‚Üì
Setup JDK 17
    ‚Üì
[GATE 1] Build
    mvn clean compile
    ‚Üì (fails ‚Üí block merge)
    ‚Üì
[GATE 2] Unit &amp; Slice Tests
    mvn test
    ‚Üì (fails ‚Üí block merge)
    ‚Üì
[GATE 3] Coverage Report
    mvn jacoco:report
    ‚Üì (coverage &lt; 70% ‚Üí block merge)
    ‚Üì
[GATE 4] Code Quality
    mvn spotbugs:check (lint)
    ‚Üì (errors ‚Üí block merge)
    ‚Üì
‚úÖ SUCCESS - Auto-merge enabled
    ‚Üì
Deploy to staging/prod</code></pre>
                <h3 id="test-execution-timeline">Test Execution
                Timeline</h3>
                <pre><code>Stage 1: Compilation    ~10 seconds (fast fail)
Stage 2: Tests          ~30 seconds (main wait)
Stage 3: Coverage       ~15 seconds
Stage 4: Code Quality   ~5 seconds
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
Total:                  ~60 seconds</code></pre>
                <hr />
                <h2 id="test-execution-stages">Test Execution
                Stages</h2>
                <h3 id="stage-1-compilation">Stage 1: Compilation</h3>
                <p><strong>Command</strong>:</p>
                <div class="sourceCode" id="cb3"><pre
                class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="ex">mvn</span> clean compile</span></code></pre></div>
                <p><strong>What it does</strong>: - Compiles source code
                - Catches syntax errors early - Fails if Java/Spring
                version mismatches</p>
                <p><strong>Output</strong>:</p>
                <pre><code>[INFO] Compiling 15 source files
[INFO] BUILD SUCCESS</code></pre>
                <p><strong>Fail Condition</strong>: Any Java syntax
                error</p>
                <hr />
                <h3 id="stage-2-unit-slice-tests">Stage 2: Unit &amp;
                Slice Tests</h3>
                <p><strong>Command</strong>:</p>
                <div class="sourceCode" id="cb5"><pre
                class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="ex">mvn</span> test</span></code></pre></div>
                <p><strong>What it runs</strong>: - All 9 test classes -
                Generates JUnit reports - ~65+ test methods (including
                parameterized variants)</p>
                <p><strong>Test Categories Run</strong>:</p>
                <pre><code>1. AuthControllerTest               (4 methods)
2. ProductControllerTest            (3-4 methods)
3. ProductCreateControllerTest       (3 methods)
4. ProductFetchControllerTest        (4-5 methods)
5. ProductUpdateControllerTest       (3 methods)
6. ProductDeleteControllerTest       (2 methods)
7. ProductPaginationControllerTest   (2 methods)
8. ProductInvalidUpdateControllerTest (1-2 methods)
9. StockEaseApplicationTests        (1 method)</code></pre>
                <p><strong>Output</strong>:</p>
                <pre><code>[INFO] -------------------------------------------------------
[INFO] T E S T S
[INFO] -------------------------------------------------------
[INFO] Running com.stocks.stockease.controller.AuthControllerTest
[INFO] Tests run: 4, Failures: 0, Errors: 0, Skipped: 0
[INFO] 
[INFO] Running com.stocks.stockease.controller.ProductControllerTest
[INFO] Tests run: 3, Failures: 0, Errors: 0, Skipped: 0
...
[INFO] BUILD SUCCESS</code></pre>
                <p><strong>Reports Generated</strong>: -
                <code>backend/target/surefire-reports/*.xml</code> ‚Äî
                JUnit XML -
                <code>backend/target/surefire-reports/*.txt</code> ‚Äî
                Test summary - <code>backend/target/test-classes/</code>
                ‚Äî Compiled tests</p>
                <p><strong>Fail Condition</strong>: Any test fails or
                errors</p>
                <hr />
                <h3 id="stage-3-coverage-report">Stage 3: Coverage
                Report</h3>
                <p><strong>Command</strong>:</p>
                <div class="sourceCode" id="cb8"><pre
                class="sourceCode bash"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="ex">mvn</span> jacoco:report</span></code></pre></div>
                <p><strong>What it does</strong>: - Instruments bytecode
                for coverage measurement - Runs tests again (with
                coverage tracking) - Generates HTML report - Calculates
                coverage percentages</p>
                <p><strong>Output</strong>:</p>
                <pre><code>[INFO] Jacoco Reports
[INFO] -------------------------------------------------------
[INFO] Class Coverage: 40% (4/10)
[INFO] Line Coverage: 65% (195/300)
[INFO] Branch Coverage: 55% (55/100)
[INFO] Method Coverage: 75% (30/40)
[INFO] Complexity Coverage: 60%
[INFO] BUILD SUCCESS</code></pre>
                <p><strong>Reports Generated</strong>: -
                <code>backend/target/site/jacoco/index.html</code> ‚Äî
                Main report -
                <code>backend/target/site/jacoco/com/stocks/stockease/controller/</code>
                ‚Äî Package details -
                <code>backend/target/site/jacoco/StatusCode.xml</code> ‚Äî
                Machine-readable</p>
                <p><strong>Fail Condition</strong>: Coverage &lt;
                configured minimum (optional gate)</p>
                <hr />
                <h3 id="stage-4-code-quality-check">Stage 4: Code
                Quality Check</h3>
                <p><strong>Command</strong> (proposed):</p>
                <div class="sourceCode" id="cb10"><pre
                class="sourceCode bash"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="ex">mvn</span> spotbugs:check  <span class="co"># or PMD, CheckStyle</span></span></code></pre></div>
                <p><strong>What it does</strong> (when configured): -
                Scans for common bugs - Checks code style violations -
                Flags security issues - Performance problems</p>
                <p><strong>Output</strong>:</p>
                <pre><code>[INFO] SpotBugs check
[WARNING] High priority: Null pointer dereference in AuthController
[WARNING] Medium priority: Unclosed resource in ProductService
[INFO] BUILD SUCCESS</code></pre>
                <p><strong>Fail Condition</strong>: High-priority issues
                found (depends on configuration)</p>
                <hr />
                <h2 id="quality-gates">Quality Gates</h2>
                <h3 id="gate-1-build-must-succeed">Gate 1: Build Must
                Succeed</h3>
                <pre><code>Condition: No compilation errors
Success: ‚úÖ Code compiles
Failure: ‚ùå Syntax error ‚Üí BLOCK merge
Action: Fix Java/Spring errors</code></pre>
                <h3 id="gate-2-all-tests-must-pass">Gate 2: All Tests
                Must Pass</h3>
                <pre><code>Condition: All 9 test classes pass
Success: ‚úÖ 0 failures, 0 errors
Failure: ‚ùå Any test fails ‚Üí BLOCK merge
Action: Fix test/code issue</code></pre>
                <h3 id="gate-3-coverage-minimum-optional">Gate 3:
                Coverage Minimum (Optional)</h3>
                <pre><code>Condition: Line coverage ‚â• 70%
Success: ‚úÖ Coverage = 72%
Failure: ‚ùå Coverage = 65% ‚Üí REQUEST review
Action: Add tests for uncovered code</code></pre>
                <h3 id="gate-4-code-quality-optional">Gate 4: Code
                Quality (Optional)</h3>
                <pre><code>Condition: No high-priority bugs
Success: ‚úÖ 0 issues
Failure: ‚ö†Ô∏è  1 issue ‚Üí WARN but allow merge
Action: Fix or add suppression</code></pre>
                <hr />
                <h2 id="failure-handling">Failure Handling</h2>
                <h3 id="scenario-1-test-fails-in-ci">Scenario 1: Test
                Fails in CI</h3>
                <pre><code>User pushes code to PR
    ‚Üì
CI runs: mvn test
    ‚Üì
‚ùå FAILURE: ProductControllerTest.testGetProductsEmpty
    ‚îÇ        Expected 0 items, got 1
    ‚Üì
GitHub marks PR as ‚ùå FAILED
    ‚Üì
PR cannot be merged until fixed
    ‚Üì
User must:
1. View failure details in GitHub Actions
2. Fix code or test
3. Push fix to same PR
4. CI re-runs automatically
5. When all pass, PR can merge</code></pre>
                <h3 id="scenario-2-coverage-drops">Scenario 2: Coverage
                Drops</h3>
                <pre><code>Previous build: 72% coverage (PASS)
New build: 68% coverage (FAIL if gate active)
    ‚Üì
CI logs warning:
  &quot;Coverage dropped from 72% to 68%&quot;
  &quot;New test needed for: ProductService.validatePrice()&quot;
    ‚Üì
Options:
- Add test to increase coverage back to 72%
- Request review if acceptable drop
- Adjust threshold if rate-limited</code></pre>
                <h3 id="scenario-3-flaky-test">Scenario 3: Flaky
                Test</h3>
                <pre><code>Test sometimes passes, sometimes fails
    ‚Üì
CI output: FAILURE on attempt 1
    ‚Üì
Actions:
- Review test for timing issues (sleep, race conditions)
- Use @BeforeEach to reset state properly
- Mock external dependencies consistently
- Increase retry count if infrastructure issue</code></pre>
                <hr />
                <h2 id="artifacts-reports">Artifacts &amp; Reports</h2>
                <h3 id="test-reports">Test Reports</h3>
                <p><strong>Location</strong>:
                <code>backend/target/surefire-reports/</code></p>
                <pre><code>TEST-com.stocks.stockease.controller.AuthControllerTest.xml
TEST-com.stocks.stockease.controller.ProductControllerTest.xml
TEST-com.stocks.stockease.controller.ProductCreateControllerTest.xml
...
com.stocks.stockease.controller.AuthControllerTest.txt
com.stocks.stockease.controller.ProductControllerTest.txt
...</code></pre>
                <p><strong>Upload to Artifacts</strong>:</p>
                <div class="sourceCode" id="cb20"><pre
                class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># .github/workflows/ci-build.yml</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Upload test reports</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">uses</span><span class="kw">:</span><span class="at"> actions/upload-artifact@v3</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">if</span><span class="kw">:</span><span class="at"> always()</span><span class="co">  # Always upload, even if tests fail</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">with</span><span class="kw">:</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">name</span><span class="kw">:</span><span class="at"> test-reports</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">path</span><span class="kw">:</span><span class="at"> backend/target/surefire-reports/</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">retention-days</span><span class="kw">:</span><span class="at"> </span><span class="dv">30</span></span></code></pre></div>
                <p><strong>View in GitHub</strong>: 1. Go to Actions ‚Üí
                Recent run 2. Scroll to Artifacts section 3. Download
                <code>test-reports.zip</code> 4. Open XML or txt
                files</p>
                <h3 id="coverage-reports">Coverage Reports</h3>
                <p><strong>Location</strong>:
                <code>backend/target/site/jacoco/</code></p>
                <pre><code>index.html
com/stocks/stockease/controller/
  AuthController.java.html
  ProductController.java.html
  ...</code></pre>
                <p><strong>Upload to Artifacts</strong>:</p>
                <div class="sourceCode" id="cb22"><pre
                class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Upload coverage report</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">uses</span><span class="kw">:</span><span class="at"> actions/upload-artifact@v3</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">if</span><span class="kw">:</span><span class="at"> always()</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">with</span><span class="kw">:</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">name</span><span class="kw">:</span><span class="at"> coverage-report</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">path</span><span class="kw">:</span><span class="at"> backend/target/site/jacoco/</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">retention-days</span><span class="kw">:</span><span class="at"> </span><span class="dv">30</span></span></code></pre></div>
                <p><strong>Publish to GitHub Pages</strong>:</p>
                <div class="sourceCode" id="cb23"><pre
                class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Deploy coverage to Pages</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">uses</span><span class="kw">:</span><span class="at"> actions/upload-pages-artifact@v2</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">with</span><span class="kw">:</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">path</span><span class="kw">:</span><span class="at"> backend/target/site/jacoco/</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Result: </span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="co"># https://keglev.github.io/stockease/coverage/</span></span></code></pre></div>
                <hr />
                <h2 id="build-status-badge">Build Status Badge</h2>
                <h3 id="display-in-readme">Display in README</h3>
                <div class="sourceCode" id="cb24"><pre
                class="sourceCode markdown"><code class="sourceCode markdown"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="al">![Build Status](https://github.com/keglev/stockease/workflows/CI/badge.svg)</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="al">![Coverage](https://img.shields.io/badge/coverage-72%25-yellow)</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="al">![Tests](https://img.shields.io/badge/tests-65%2B-blue)</span></span></code></pre></div>
                <h3 id="links-to-reports">Links to Reports</h3>
                <div class="sourceCode" id="cb25"><pre
                class="sourceCode markdown"><code class="sourceCode markdown"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">## Test Results</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Latest Build</span><span class="co">](https://github.com/keglev/stockease/actions)</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Coverage Report</span><span class="co">](https://keglev.github.io/stockease/coverage/)</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Test Logs</span><span class="co">](https://github.com/keglev/stockease/actions/workflows/ci-build.yml)</span></span></code></pre></div>
                <hr />
                <h2 id="typical-ci-workflow">Typical CI Workflow</h2>
                <h3 id="scenario-developer-pushes-new-feature">Scenario:
                Developer Pushes New Feature</h3>
                <pre><code>1. Developer commits ProductCreateControllerTest changes
2. Pushes to branch: feature/admin-create-product
3. Creates PR ‚Üí Runs CI

GitHub Actions Workflow:
‚îú‚îÄ Checkout code
‚îú‚îÄ Setup JDK 17
‚îú‚îÄ mvn clean compile          ‚úÖ Pass
‚îú‚îÄ mvn test                   ‚úÖ Pass (9 classes)
‚îú‚îÄ mvn jacoco:report          ‚úÖ Pass (72% coverage)
‚îú‚îÄ mvn spotbugs:check         ‚úÖ Pass (no issues)
‚îî‚îÄ ‚úÖ SUCCESS

GitHub UI:
‚îú‚îÄ PR shows ‚úÖ All checks passed
‚îú‚îÄ Green checkmark on PR
‚îú‚îÄ &quot;Merge pull request&quot; button enabled
‚îî‚îÄ Maintainer can click to merge

After Merge:
‚îú‚îÄ CI runs again on main branch
‚îú‚îÄ All checks pass
‚îú‚îÄ Auto-deploys to staging (if configured)
‚îî‚îÄ Feature live on main</code></pre>
                <hr />
                <h2 id="performance-optimization">Performance
                Optimization</h2>
                <h3 id="current-performance">Current Performance</h3>
                <pre><code>Compilation:     ~10 seconds
Tests:           ~30 seconds  (bottleneck)
Coverage:        ~15 seconds
Quality:         ~5 seconds
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
Total:           ~60 seconds</code></pre>
                <h3 id="optimization-options">Optimization Options</h3>
                <table>
                <thead>
                <tr class="header">
                <th>Optimization</th>
                <th>Impact</th>
                <th>Complexity</th>
                </tr>
                </thead>
                <tbody>
                <tr class="odd">
                <td>Parallel test execution</td>
                <td>Save 10-15 sec</td>
                <td>Medium</td>
                </tr>
                <tr class="even">
                <td>Test caching</td>
                <td>Save 5-10 sec</td>
                <td>High</td>
                </tr>
                <tr class="odd">
                <td>Smaller Docker images</td>
                <td>Save 5 sec</td>
                <td>Low</td>
                </tr>
                <tr class="even">
                <td>Split CI into sub-jobs</td>
                <td>Psychological</td>
                <td>High</td>
                </tr>
                </tbody>
                </table>
                <hr />
                <h2 id="debugging-ci-failures">Debugging CI
                Failures</h2>
                <h3 id="step-1-review-failure-log">Step 1: Review
                Failure Log</h3>
                <pre><code>1. Go to Actions ‚Üí Recent run
2. Click failed job
3. Expand test output
4. Find [ERROR] or [FAILED] lines
5. Note exact failure message</code></pre>
                <h3 id="step-2-reproduce-locally">Step 2: Reproduce
                Locally</h3>
                <div class="sourceCode" id="cb29"><pre
                class="sourceCode bash"><code class="sourceCode bash"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On your machine:</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> backend</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="ex">mvn</span> clean test</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="co"># If it passes locally but fails in CI:</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="co"># - Different JDK version (use jdk-17 in CI)</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="co"># - Different environment variables</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="co"># - Timing/race condition (flaky test)</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="co"># - File permission issue</span></span></code></pre></div>
                <h3 id="step-3-check-ci-configuration">Step 3: Check CI
                Configuration</h3>
                <div class="sourceCode" id="cb30"><pre
                class="sourceCode bash"><code class="sourceCode bash"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Review .github/workflows/ci-build.yml:</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="co"># - JDK version matches local</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="co"># - Maven version specified</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co"># - Test timeout settings</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="co"># - Environment variables set</span></span></code></pre></div>
                <h3 id="step-4-add-debug-output">Step 4: Add Debug
                Output</h3>
                <div class="sourceCode" id="cb31"><pre
                class="sourceCode java"><code class="sourceCode java"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Add logging in test</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="at">@Test</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> <span class="fu">testFailing</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">System</span><span class="op">.</span><span class="fu">out</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span><span class="st">&quot;DEBUG: Starting test&quot;</span><span class="op">);</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">System</span><span class="op">.</span><span class="fu">out</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span><span class="st">&quot;DEBUG: Product = &quot;</span> <span class="op">+</span> product<span class="op">);</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">assertThat</span><span class="op">(</span>result<span class="op">).</span><span class="fu">isEqualTo</span><span class="op">(</span>expected<span class="op">);</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="co">// Re-run and check CI logs</span></span></code></pre></div>
                <hr />
                <h2 id="related-documentation">Related
                Documentation</h2>
                <h3 id="testing-fundamentals">Testing Fundamentals</h3>
                <ul>
                <li><strong><a href="./strategy.html">Testing
                Strategy</a></strong> ‚Äî CI scope and philosophy</li>
                <li><strong><a
                href="./coverage-and-quality.html">Coverage &amp;
                Quality</a></strong> ‚Äî JaCoCo in CI</li>
                <li><strong><a href="./pyramid.html">Test
                Pyramid</a></strong> ‚Äî Test distribution</li>
                </ul>
                <h3 id="implementation">Implementation</h3>
                <ul>
                <li><strong><a href="./spring-slices.html">Spring
                Slices</a></strong> ‚Äî Tests run in CI</li>
                <li><strong><a
                href="./controller-integration.html">Controller
                Integration Tests</a></strong> ‚Äî HTTP tests</li>
                </ul>
                <h3 id="architecture">Architecture</h3>
                <ul>
                <li><strong><a
                href="../testing-architecture.html">Testing
                Architecture</a></strong> ‚Äî Entry point</li>
                <li><strong><a
                href="../deployment.html">Deployment</a></strong> ‚Äî
                CI/CD pipeline details</li>
                <li><strong><a href="../backend.html">Backend
                Architecture</a></strong> ‚Äî Code being tested</li>
                </ul>
                <hr />
                <p><strong>Last Updated</strong>: October 31, 2025<br />
                <strong>Version</strong>: 1.0<br />
                <strong>Status</strong>: ‚úÖ Proposal ready for
                implementation</p>
                <p><a href="../testing-architecture.html">Back to
                Testing Index</a></p>
            </div>
        </main>
    </aside>

    <footer>
        <div class="footer-content">
            <p><strong>StockEase</strong> - Inventory Management System</p>
            <p>Architecture Documentation | Generated with Enterprise Standards</p>
            <p style="opacity: 0.7; font-size: 0.85rem;">¬© 2025 Team StockEase. All rights reserved.</p>
        </div>
    </footer>

    <script>
        // Calculate relative path to architecture root based on current location
        function getArchRoot() {
            const path = window.location.pathname;
            const segments = path.split('/').filter(s => s);
            
            // Find how many levels deep we are from 'architecture' folder
            const archIndex = segments.indexOf('architecture');
            if (archIndex === -1) return './';
            
            const depth = segments.length - archIndex - 2; // -2 for architecture and filename
            if (depth <= 0) return './';
            
            return '../'.repeat(depth);
        }

        // Navigation Menu (paths relative to architecture root)
        const navigation = {
            'API Documentation': [
                { label: 'Overview', href: 'api-docs.html', isApiDoc: true },
            ],
            'Architecture': [
                { label: 'Overview', href: 'overview.html' },
                { label: 'System Layers', href: 'layers.html' },
                { label: 'Backend Architecture', href: 'backend.html' },
                { label: 'Frontend Architecture', href: 'frontend.html' },
                { label: 'Security Architecture', href: 'security.html' },
                { label: 'Deployment Strategy', href: 'deployment.html' },
            ],
            'Design Decisions': [
                { label: 'Index', href: 'decisions/index.html' },
            ],
            'Components': [
                { label: 'Index', href: 'components/index.html' },
                { label: 'Analytics Service', href: 'components/analytics-service.html' },
                { label: 'Supplier Controller', href: 'components/supplier-controller.html' },
            ],
            'Patterns': [
                { label: 'Index', href: 'patterns/index.html' },
                { label: 'Repository Pattern', href: 'patterns/repository-pattern.html' },
                { label: 'Security Patterns', href: 'patterns/security-patterns.html' },
            ],
            'Testing': [
                { label: 'Architecture', href: 'testing-architecture.html' },
                { label: 'Test Pyramid', href: 'testing/pyramid.html' },
                { label: 'Strategy', href: 'testing/strategy.html' },
                { label: 'Spring Slices', href: 'testing/spring-slices.html' },
                { label: 'Test Data Fixtures', href: 'testing/test-data-fixtures.html' },
                { label: 'Security Tests', href: 'testing/security-tests.html' },
                { label: 'Naming Conventions', href: 'testing/naming-conventions.html' },
                { label: 'Test Matrix', href: 'testing/matrix.html' },
                { label: 'Coverage & Quality', href: 'testing/coverage-and-quality.html' },
                { label: 'Controller Integration', href: 'testing/controller-integration.html' },
                { label: 'CI Pipeline Tests', href: 'testing/ci-pipeline-tests.html' },
            ],
            'Deployment': [
                { label: 'Overview', href: 'deployment.html' },
                { label: 'CI/CD Pipeline', href: 'deployment/ci-pipeline.html' },
                { label: 'Docker Strategy', href: 'deployment/docker-strategy.html' },
                { label: 'Staging Config', href: 'deployment/staging-config.html' },
            ],
            'Reference': [
                { label: 'Documentation Guide', href: 'DOCUMENTATION-GUIDE.html' },
                { label: 'HTML Generation', href: 'DOCUMENTATION-GENERATION.html' },
                { label: 'Redundancy Analysis', href: 'REDUNDANCY-ANALYSIS.html' },
            ],
        };

        // Build sidebar
        function buildSidebar() {
            const sidebar = document.getElementById('sidebar');
            if (!sidebar) return;

            const archRoot = getArchRoot();

            Object.entries(navigation).forEach(([section, links]) => {
                const navSection = document.createElement('div');
                navSection.className = 'nav-section';

                const title = document.createElement('div');
                title.className = 'nav-section-title';
                title.textContent = section;
                navSection.appendChild(title);

                const ul = document.createElement('ul');
                links.forEach(link => {
                    const li = document.createElement('li');
                    const a = document.createElement('a');
                    
                    // For API docs, go up to docs root; otherwise use architecture root
                    if (link.isApiDoc) {
                        a.href = archRoot + '../' + link.href;
                    } else {
                        a.href = archRoot + link.href;
                    }
                    
                    a.textContent = link.label;

                    // Highlight current page
                    const currentPath = window.location.pathname;
                    const linkPath = link.href.replace('.html', '');
                    if (currentPath.endsWith(link.href) || currentPath.includes(linkPath)) {
                        a.className = 'active';
                    }

                    li.appendChild(a);
                    ul.appendChild(li);
                });

                navSection.appendChild(ul);
                sidebar.appendChild(navSection);
            });
        }

        // Build table of contents highlight
        function initTableOfContents() {
            const tocLinks = document.querySelectorAll('nav.toc a');
            const headings = document.querySelectorAll('h2, h3');

            window.addEventListener('scroll', () => {
                let currentHeading = null;
                headings.forEach(heading => {
                    if (heading.getBoundingClientRect().top <= 100) {
                        currentHeading = heading;
                    }
                });

                tocLinks.forEach(link => {
                    link.classList.remove('active');
                    if (currentHeading) {
                        const href = link.getAttribute('href');
                        if (href === '#' + currentHeading.id) {
                            link.classList.add('active');
                        }
                    }
                });
            });
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            buildSidebar();
            initTableOfContents();
        });
    </script>

    <!-- Mermaid.js for diagram rendering -->
    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        
        // Debug logging
        console.log('üîß Mermaid module loaded');
        
        mermaid.initialize({ 
            startOnLoad: false,
            theme: 'default',
            securityLevel: 'loose',
            fontFamily: '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',
        });
        
        console.log('üîß Mermaid initialized');
        
        // Look for mermaid divs that were generated by Pandoc Lua filter
        const mermaidDivs = document.querySelectorAll('div.mermaid');
        console.log('üîß Found ' + mermaidDivs.length + ' div.mermaid blocks');
        
        mermaidDivs.forEach((div, index) => {
            console.log('  Found mermaid diagram ' + (index + 1) + ': ' + div.textContent.substring(0, 50) + '...');
        });
        
        // Also look for any code.language-mermaid blocks (fallback)
        const codeMermaidBlocks = document.querySelectorAll('code.language-mermaid');
        console.log('üîß Found ' + codeMermaidBlocks.length + ' code.language-mermaid blocks');
        
        codeMermaidBlocks.forEach((code, index) => {
            console.log('  Converting code block ' + (index + 1) + ': ' + code.textContent.substring(0, 50) + '...');
            code.classList.remove('language-mermaid');
            code.classList.add('mermaid');
            // If wrapped in pre, mark pre as mermaid too
            if (code.parentElement.tagName === 'PRE') {
                code.parentElement.classList.add('mermaid-block');
            }
        });
        
        console.log('üîß Class conversion complete');
        
        // Wait for DOM to be fully loaded, then render all mermaid diagrams
        if (document.readyState === 'loading') {
            console.log('üîß DOM still loading, waiting for DOMContentLoaded event');
            document.addEventListener('DOMContentLoaded', async () => {
                console.log('üîß DOMContentLoaded fired, running mermaid.run()');
                try {
                    await mermaid.run();
                    console.log('‚úì Mermaid rendering complete');
                } catch (err) {
                    console.error('‚ùå Mermaid rendering error:', err);
                }
            });
        } else {
            console.log('üîß DOM already loaded, running mermaid.run() immediately');
            // Already loaded
            mermaid.run().then(() => {
                console.log('‚úì Mermaid rendering complete');
            }).catch(err => {
                console.error('‚ùå Mermaid rendering error:', err);
            });
        }
    </script>
</body>
</html>
