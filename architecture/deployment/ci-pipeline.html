<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> - StockEase Architecture Documentation</title>
    <style>
        :root {
            --primary: #0066cc;
            --primary-dark: #004a99;
            --primary-light: #e6f0ff;
            --secondary: #6c757d;
            --success: #28a745;
            --danger: #dc3545;
            --warning: #ffc107;
            --info: #17a2b8;
            --text: #212529;
            --text-light: #6c757d;
            --border: #dee2e6;
            --bg-light: #f8f9fa;
            --bg-white: #ffffff;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
                'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
                sans-serif;
            color: var(--text);
            background-color: var(--bg-light);
            line-height: 1.6;
        }

        /* Header & Navigation */
        header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            padding: 1rem 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: 700;
            text-decoration: none;
            color: white;
        }

        .nav-breadcrumb {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .nav-breadcrumb a {
            color: white;
            text-decoration: none;
            transition: opacity 0.2s;
        }

        .nav-breadcrumb a:hover {
            opacity: 0.8;
        }

        /* Main Layout */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1.5rem;
            display: grid;
            grid-template-columns: 250px 1fr;
            gap: 2rem;
        }

        /* Sidebar Navigation */
        aside {
            padding: 2rem 0;
        }

        .nav-section {
            margin-bottom: 2rem;
        }

        .nav-section-title {
            font-size: 0.85rem;
            font-weight: 700;
            text-transform: uppercase;
            color: var(--secondary);
            margin-bottom: 0.5rem;
            padding: 0.5rem 0;
        }

        .nav-section ul {
            list-style: none;
        }

        .nav-section li {
            margin: 0.25rem 0;
        }

        .nav-section a {
            display: block;
            padding: 0.5rem 0.75rem;
            color: var(--text);
            text-decoration: none;
            border-radius: 4px;
            transition: all 0.2s;
            font-size: 0.95rem;
        }

        .nav-section a:hover {
            background-color: var(--primary-light);
            color: var(--primary-dark);
        }

        .nav-section a.active {
            background-color: var(--primary);
            color: white;
            font-weight: 600;
        }

        /* Main Content */
        main {
            padding: 2rem 0;
            min-height: calc(100vh - 200px);
        }

        .content {
            background: var(--bg-white);
            border-radius: 8px;
            padding: 2rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }

        /* Typography */
        h1 {
            font-size: 2rem;
            margin-bottom: 0.5rem;
            color: var(--primary-dark);
            border-bottom: 3px solid var(--primary);
            padding-bottom: 0.5rem;
        }

        h2 {
            font-size: 1.5rem;
            margin-top: 1.5rem;
            margin-bottom: 0.75rem;
            color: var(--primary-dark);
        }

        h3 {
            font-size: 1.25rem;
            margin-top: 1.25rem;
            margin-bottom: 0.5rem;
            color: var(--text);
        }

        h4, h5, h6 {
            margin-top: 1rem;
            margin-bottom: 0.5rem;
        }

        p {
            margin-bottom: 1rem;
        }

        /* Lists */
        ul, ol {
            margin-left: 1.5rem;
            margin-bottom: 1rem;
        }

        li {
            margin-bottom: 0.5rem;
        }

        /* Code */
        code {
            background-color: var(--bg-light);
            padding: 0.2rem 0.4rem;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            color: var(--danger);
        }

        pre {
            background-color: #1e1e1e;
            color: #d4d4d4;
            padding: 1rem;
            border-radius: 6px;
            overflow-x: auto;
            margin-bottom: 1rem;
            border-left: 3px solid var(--primary);
        }

        pre code {
            background: none;
            color: inherit;
            padding: 0;
        }

        /* Tables */
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 1rem;
        }

        table thead {
            background-color: var(--primary);
            color: white;
        }

        table th {
            padding: 0.75rem;
            text-align: left;
            font-weight: 600;
        }

        table td {
            padding: 0.75rem;
            border-bottom: 1px solid var(--border);
        }

        table tbody tr:nth-child(even) {
            background-color: var(--bg-light);
        }

        table tbody tr:hover {
            background-color: #f0f6ff;
        }

        /* Blockquotes */
        blockquote {
            border-left: 4px solid var(--primary);
            padding-left: 1rem;
            margin-left: 0;
            margin-bottom: 1rem;
            color: var(--text-light);
            font-style: italic;
        }

        /* Links */
        a {
            color: var(--primary);
            text-decoration: none;
            transition: color 0.2s;
        }

        a:hover {
            color: var(--primary-dark);
            text-decoration: underline;
        }

        /* Alerts / Boxes */
        .info-box, .warning-box, .success-box, .danger-box {
            padding: 1rem;
            border-radius: 4px;
            margin-bottom: 1rem;
            border-left: 4px solid;
        }

        .info-box {
            background-color: #e7f3ff;
            border-color: var(--info);
            color: #004a87;
        }

        .warning-box {
            background-color: #fff3cd;
            border-color: var(--warning);
            color: #856404;
        }

        .success-box {
            background-color: #d4edda;
            border-color: var(--success);
            color: #155724;
        }

        .danger-box {
            background-color: #f8d7da;
            border-color: var(--danger);
            color: #721c24;
        }

        /* TOC */
        nav.toc {
            background-color: var(--bg-light);
            padding: 1rem;
            border-radius: 4px;
            margin-bottom: 2rem;
            max-height: 400px;
            overflow-y: auto;
        }

        nav.toc ul {
            list-style: none;
            margin-left: 0;
        }

        nav.toc li {
            margin: 0.25rem 0;
        }

        nav.toc a {
            font-size: 0.95rem;
        }

        nav.toc > ul > li > a {
            font-weight: 600;
            color: var(--primary);
        }

        /* Footer */
        footer {
            background-color: var(--text);
            color: white;
            padding: 2rem;
            margin-top: 2rem;
            text-align: center;
        }

        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
        }

        .footer-content p {
            margin: 0.25rem 0;
            font-size: 0.9rem;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .container {
                grid-template-columns: 1fr;
            }

            aside {
                order: 2;
            }

            main {
                order: 1;
            }

            h1 {
                font-size: 1.5rem;
            }

            h2 {
                font-size: 1.25rem;
            }

            .header-content {
                flex-direction: column;
                gap: 0.5rem;
            }

            .nav-breadcrumb {
                font-size: 0.8rem;
            }
        }

        /* Print Styles */
        @media print {
            header, aside, footer {
                display: none;
            }

            .content {
                box-shadow: none;
                background: white;
            }
        }

        /* Syntax Highlighting (basic) */
        .hljs-keyword { color: #569cd6; }
        .hljs-string { color: #ce9178; }
        .hljs-number { color: #b5cea8; }
        .hljs-attr { color: #9cdcfe; }
        .hljs-comment { color: #6a9955; font-style: italic; }
    </style>
</head>
<body>
    <header>
        <div class="header-content">
            <a href="/stockease/" class="logo">ğŸ“š StockEase Architecture Docs</a>
            <nav class="nav-breadcrumb">
                <a href="/stockease/">Home</a> / <span id="breadcrumb">Documentation</span>
            </nav>
        </div>
    </header>

    <div class="container">
        <aside id="sidebar"></aside>
        <main>
            <div class="content">
                <h1 id="cicd-pipeline-architecture">CI/CD Pipeline
                Architecture</h1>
                <h2 id="overview">Overview</h2>
                <p>The CI/CD pipeline automates building, testing, and
                deploying StockEase to production. Two workflows manage
                the process: - <strong>auto_deploy.yml</strong>: Builds
                and deploys backend to Koyeb -
                <strong>docs-ci.yml</strong>: Generates documentation
                and publishes to GitHub Pages</p>
                <h2 id="deployment-workflow-auto_deploy.yml">Deployment
                Workflow (auto_deploy.yml)</h2>
                <h3 id="trigger-events">Trigger Events</h3>
                <div class="sourceCode" id="cb1"><pre
                class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">on</span><span class="kw">:</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">push</span><span class="kw">:</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">branches</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> main </span><span class="kw">]</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">paths-ignore</span><span class="kw">:</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="st">&#39;docs/**&#39;</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="st">&#39;.gitignore&#39;</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">workflow_dispatch</span><span class="kw">:</span><span class="co">  # Manual trigger</span></span></code></pre></div>
                <p><strong>Triggers on</strong>: - Push to main branch
                (excluding docs directory) - Manual workflow
                dispatch</p>
                <p><strong>Doesnâ€™t trigger on</strong>: - Changes to
                <code>/docs/</code> only - Changes to
                <code>.gitignore</code> only</p>
                <h3 id="pipeline-stages">Pipeline Stages</h3>
                <pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. Checkout Code                    â”‚
â”‚ Fetch repository from GitHub        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. Setup Java Environment           â”‚
â”‚ JDK 17, Maven cache, dependencies   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. Run Tests (65+ tests)            â”‚
â”‚ H2 database, ~1 minute              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â†“
        âœ… Pass? â†’ Continue
        âŒ Fail? â†’ Stop, notify
               â”‚
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. Build Application                â”‚
â”‚ Maven package, create JAR           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. Build Docker Image               â”‚
â”‚ ghcr.io/keglev/stockease:latest     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 6. Push to Container Registry       â”‚
â”‚ GHCR authentication, push image     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 7. Deploy to Koyeb                  â”‚
â”‚ Trigger redeploy via API            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 8. Wait for Healthy (up to 10 min)  â”‚
â”‚ Poll service status                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â†“
        âœ… Healthy â†’ Success
        âŒ Timeout â†’ Failure notification</code></pre>
                <h3 id="stage-details">Stage Details</h3>
                <h4 id="stage-1-checkout">Stage 1: Checkout</h4>
                <div class="sourceCode" id="cb3"><pre
                class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Checkout repository</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">uses</span><span class="kw">:</span><span class="at"> actions/checkout@v4</span></span></code></pre></div>
                <p><strong>Duration</strong>: ~5 seconds<br />
                <strong>Purpose</strong>: Clone repository with full
                history</p>
                <h4 id="stage-2-setup-environment">Stage 2: Setup
                Environment</h4>
                <div class="sourceCode" id="cb4"><pre
                class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Set up JDK 17 with Maven cache</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">uses</span><span class="kw">:</span><span class="at"> actions/setup-java@v4</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">with</span><span class="kw">:</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">distribution</span><span class="kw">:</span><span class="at"> temurin</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">java-version</span><span class="kw">:</span><span class="at"> </span><span class="st">&#39;17&#39;</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">cache</span><span class="kw">:</span><span class="at"> maven</span></span></code></pre></div>
                <p><strong>Duration</strong>: ~30 seconds (first run),
                ~5 seconds (cached)<br />
                <strong>Purpose</strong>: Install JDK 17 and Maven
                dependencies</p>
                <h4 id="stage-3-run-tests">Stage 3: Run Tests</h4>
                <div class="sourceCode" id="cb5"><pre
                class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Run backend tests</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">run</span><span class="kw">:</span><span class="at"> ./mvnw -B -ntp test</span></span></code></pre></div>
                <p><strong>Duration</strong>: ~30-45 seconds<br />
                <strong>Tests</strong>: 65+ unit and integration
                tests<br />
                <strong>Database</strong>: H2 in-memory<br />
                <strong>Failure Handling</strong>: Stops pipeline if
                tests fail</p>
                <h4 id="stage-4-build">Stage 4: Build</h4>
                <div class="sourceCode" id="cb6"><pre
                class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Verify build compiles</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">run</span><span class="kw">:</span><span class="at"> ./mvnw -B -ntp -DskipTests package</span></span></code></pre></div>
                <p><strong>Duration</strong>: ~20-30 seconds<br />
                <strong>Purpose</strong>: Create JAR file, catch compile
                errors</p>
                <h4 id="stage-5-build-docker-image">Stage 5: Build
                Docker Image</h4>
                <div class="sourceCode" id="cb7"><pre
                class="sourceCode dockerfile"><code class="sourceCode dockerfile"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> eclipse-temurin:17-jre-alpine</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="kw">COPY</span> target/stockease-backend-*.jar app.jar</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="kw">ENTRYPOINT</span> [<span class="st">&quot;java&quot;</span>, <span class="st">&quot;-jar&quot;</span>, <span class="st">&quot;app.jar&quot;</span>]</span></code></pre></div>
                <p><strong>Duration</strong>: ~15-20 seconds<br />
                <strong>Base Image</strong>: Alpine (122MB)<br />
                <strong>Final Size</strong>: ~350MB (with JAR +
                libs)</p>
                <h4 id="stage-6-push-to-ghcr">Stage 6: Push to GHCR</h4>
                <div class="sourceCode" id="cb8"><pre
                class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Push to GHCR</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">env</span><span class="kw">:</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">REGISTRY</span><span class="kw">:</span><span class="at"> ghcr.io</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">run</span><span class="kw">:</span><span class="at"> docker push ghcr.io/keglev/stockease:latest</span></span></code></pre></div>
                <p><strong>Duration</strong>: ~10-15 seconds<br />
                <strong>Authentication</strong>: GitHub token from
                secrets</p>
                <h4 id="stage-7-deploy-to-koyeb">Stage 7: Deploy to
                Koyeb</h4>
                <div class="sourceCode" id="cb9"><pre
                class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Trigger Koyeb redeploy</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">env</span><span class="kw">:</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">KOYEB_API_KEY</span><span class="kw">:</span><span class="at"> ${{ secrets.KOYEB_API_KEY }}</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">KOYEB_SERVICE_ID</span><span class="kw">:</span><span class="at"> ${{ secrets.KOYEB_SERVICE_ID }}</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">  run</span><span class="kw">: </span><span class="ch">|</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    curl -X POST https://app.koyeb.com/v1/services/$SERVICE_ID/redeploy \</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>      -H &quot;Authorization: Bearer $KOYEB_API_KEY&quot;</span></code></pre></div>
                <p><strong>Duration</strong>: ~5 seconds (API
                call)<br />
                <strong>Actual Deployment</strong>: 1-2 minutes (Koyeb
                pulls image, starts container)</p>
                <h4 id="stage-8-health-check">Stage 8: Health Check</h4>
                <div class="sourceCode" id="cb10"><pre
                class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Wait for Koyeb service HEALTHY</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">  run</span><span class="kw">: </span><span class="ch">|</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    for i in {1..60}; do</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>      STATUS=$(curl -H &quot;Authorization: Bearer $API_KEY&quot; \</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>        https://app.koyeb.com/v1/services/$SERVICE_ID)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>      if [ &quot;$STATUS&quot; = &quot;HEALTHY&quot; ]; then</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>        exit 0</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>      fi</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>      sleep 10</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    done</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    exit 1</span></code></pre></div>
                <p><strong>Duration</strong>: Up to 10 minutes (poll
                every 10 seconds)<br />
                <strong>Success Criteria</strong>: Service reaches
                HEALTHY status<br />
                <strong>Failure Handling</strong>: Auto-rollback if
                health check fails</p>
                <h3 id="total-pipeline-duration">Total Pipeline
                Duration</h3>
                <table>
                <thead>
                <tr class="header">
                <th>Stage</th>
                <th>Duration</th>
                </tr>
                </thead>
                <tbody>
                <tr class="odd">
                <td>Checkout</td>
                <td>5s</td>
                </tr>
                <tr class="even">
                <td>Setup</td>
                <td>30s</td>
                </tr>
                <tr class="odd">
                <td>Tests</td>
                <td>40s</td>
                </tr>
                <tr class="even">
                <td>Build</td>
                <td>25s</td>
                </tr>
                <tr class="odd">
                <td>Docker</td>
                <td>20s</td>
                </tr>
                <tr class="even">
                <td>Push</td>
                <td>15s</td>
                </tr>
                <tr class="odd">
                <td>Deploy (API)</td>
                <td>5s</td>
                </tr>
                <tr class="even">
                <td>Health Check</td>
                <td>10-120s</td>
                </tr>
                <tr class="odd">
                <td><strong>Total</strong></td>
                <td><strong>2-5 minutes</strong></td>
                </tr>
                </tbody>
                </table>
                <h2
                id="documentation-workflow-docs-ci.yml">Documentation
                Workflow (docs-ci.yml)</h2>
                <h3 id="trigger-events-1">Trigger Events</h3>
                <div class="sourceCode" id="cb11"><pre
                class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">on</span><span class="kw">:</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">push</span><span class="kw">:</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">branches</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> main </span><span class="kw">]</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">paths</span><span class="kw">:</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="st">&#39;backend/docs/**&#39;</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">workflow_dispatch</span><span class="kw">:</span></span></code></pre></div>
                <p><strong>Triggers on</strong>: - Push to main when
                <code>/backend/docs/</code> changes - Manual workflow
                dispatch</p>
                <h3 id="pipeline-stages-1">Pipeline Stages</h3>
                <pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. Checkout Code                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. Setup Environment                 â”‚
â”‚ Python, Node.js, MkDocs, ReDoc CLI   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. Start Backend (Spring Boot)       â”‚
â”‚ Start application for OpenAPI /v3    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. Extract OpenAPI Spec              â”‚
â”‚ Fetch /v3/api-docs.yaml              â”‚
â”‚ Save to docs/api/openapi/            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. Generate Redoc HTML               â”‚
â”‚ redoc-cli build-docs openapi.yaml    â”‚
â”‚ Output: docs/api/redoc/index.html    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 6. Convert Markdown to HTML          â”‚
â”‚ MkDocs build docs/architecture/      â”‚
â”‚ Output: docs/architecture/*.html     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 7. Generate Coverage Reports         â”‚
â”‚ JaCoCo site generation               â”‚
â”‚ Copy to docs/coverage/               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 8. Commit to gh-pages Branch         â”‚
â”‚ git checkout gh-pages                â”‚
â”‚ Copy all generated files             â”‚
â”‚ git commit &amp;&amp; push                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â†“
         GitHub Pages auto-publishes
    https://Keglev.github.io/stockease/</code></pre>
                <h2 id="secret-management">Secret Management</h2>
                <h3 id="required-github-secrets">Required GitHub
                Secrets</h3>
                <table>
                <colgroup>
                <col style="width: 23%" />
                <col style="width: 26%" />
                <col style="width: 23%" />
                <col style="width: 26%" />
                </colgroup>
                <thead>
                <tr class="header">
                <th>Secret</th>
                <th>Purpose</th>
                <th>Set On</th>
                <th>Used By</th>
                </tr>
                </thead>
                <tbody>
                <tr class="odd">
                <td><code>KOYEB_API_KEY</code></td>
                <td>Deploy to Koyeb</td>
                <td>Settings â†’ Secrets</td>
                <td>auto_deploy.yml</td>
                </tr>
                <tr class="even">
                <td><code>KOYEB_SERVICE_ID</code></td>
                <td>Target service</td>
                <td>Settings â†’ Secrets</td>
                <td>auto_deploy.yml</td>
                </tr>
                <tr class="odd">
                <td><code>GITHUB_TOKEN</code></td>
                <td>CI/CD operations</td>
                <td>Auto-provided</td>
                <td>docs-ci.yml</td>
                </tr>
                </tbody>
                </table>
                <h3 id="no-secrets-in-code">No Secrets in Code</h3>
                <p>âœ… <strong>Secrets in environment variables
                only</strong>:</p>
                <div class="sourceCode" id="cb13"><pre
                class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">env</span><span class="kw">:</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">KOYEB_API_KEY</span><span class="kw">:</span><span class="at"> ${{ secrets.KOYEB_API_KEY }}</span></span></code></pre></div>
                <p>âŒ <strong>Never hardcode secrets</strong>:</p>
                <div class="sourceCode" id="cb14"><pre
                class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">env</span><span class="kw">:</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">KOYEB_API_KEY</span><span class="kw">:</span><span class="at"> abc123...</span><span class="co"> # NEVER!</span></span></code></pre></div>
                <h2 id="failure-handling">Failure Handling</h2>
                <h3 id="test-failures">Test Failures</h3>
                <pre><code>If tests fail:
1. Pipeline stops immediately
2. GitHub marks commit as failed
3. Notification sent
4. Manual review required before retry</code></pre>
                <p><strong>Recovery</strong>: - Fix failing tests -
                Commit fix to main - Pipeline automatically re-runs</p>
                <h3 id="build-failures">Build Failures</h3>
                <pre><code>If build fails:
1. JAR creation fails
2. Pipeline stops at build stage
3. Notification sent
4. Check compilation errors in logs</code></pre>
                <h3 id="deployment-failures">Deployment Failures</h3>
                <pre><code>If Koyeb health check fails:
1. Service status remains UNHEALTHY
2. Previous healthy version still running
3. Auto-rollback (no manual intervention)
4. Notification sent for investigation</code></pre>
                <h3 id="health-check-timeout">Health Check Timeout</h3>
                <pre><code>If service doesn&#39;t reach HEALTHY in 10 minutes:
1. Deployment marked as failed
2. Service remains in unhealthy state
3. Manual investigation required
4. Can manually trigger redeploy once fixed</code></pre>
                <h2 id="rollback-strategy">Rollback Strategy</h2>
                <h3 id="automatic-rollback">Automatic Rollback</h3>
                <ul>
                <li>Health checks fail â†’ Previous version
                auto-deployed</li>
                <li>No manual intervention needed</li>
                <li>Happens within 1-2 minutes</li>
                </ul>
                <h3 id="manual-rollback">Manual Rollback</h3>
                <div class="sourceCode" id="cb19"><pre
                class="sourceCode bash"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Via Koyeb dashboard</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Or trigger auto_deploy on specific commit:</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> push origin <span class="op">&lt;</span>commit-sha<span class="op">&gt;</span>:main</span></code></pre></div>
                <h2 id="performance-optimization">Performance
                Optimization</h2>
                <h3 id="caching-strategy">Caching Strategy</h3>
                <ul>
                <li>Maven dependencies cached</li>
                <li>Docker layer caching</li>
                <li>GitHub Actions cache</li>
                </ul>
                <h3 id="parallel-execution-future">Parallel Execution
                (Future)</h3>
                <ul>
                <li>Run tests in parallel</li>
                <li>Build multiple artifacts simultaneously</li>
                </ul>
                <h2 id="monitoring-debugging">Monitoring &amp;
                Debugging</h2>
                <h3 id="workflow-logs">Workflow Logs</h3>
                <ul>
                <li>View at: GitHub Repo â†’ Actions â†’ Workflow runs</li>
                <li>Click run â†’ View all jobs</li>
                <li>Expand any failed step to see logs</li>
                </ul>
                <h3 id="common-issues">Common Issues</h3>
                <table>
                <thead>
                <tr class="header">
                <th>Issue</th>
                <th>Cause</th>
                <th>Fix</th>
                </tr>
                </thead>
                <tbody>
                <tr class="odd">
                <td>Tests fail</td>
                <td>Code regression</td>
                <td>Fix failing tests, commit</td>
                </tr>
                <tr class="even">
                <td>Build timeout</td>
                <td>Large dependencies</td>
                <td>Increase timeout, optimize POM</td>
                </tr>
                <tr class="odd">
                <td>Deploy timeout</td>
                <td>Koyeb slow</td>
                <td>Wait or check Koyeb status</td>
                </tr>
                <tr class="even">
                <td>Health check fails</td>
                <td>App crashed</td>
                <td>Check application logs on Koyeb</td>
                </tr>
                <tr class="odd">
                <td>Docker push fails</td>
                <td>Registry auth</td>
                <td>Verify <code>GITHUB_TOKEN</code> secret</td>
                </tr>
                </tbody>
                </table>
                <h2 id="best-practices">Best Practices</h2>
                <ol type="1">
                <li><strong>Keep workflows simple</strong> - One job per
                workflow</li>
                <li><strong>Fail fast</strong> - Stop on first
                error</li>
                <li><strong>Cache aggressively</strong> - Maven, Docker
                layers</li>
                <li><strong>Use environments</strong> - Secrets scoped
                per environment</li>
                <li><strong>Monitor carefully</strong> - Check logs
                regularly</li>
                <li><strong>Document changes</strong> - Update workflows
                when code changes</li>
                <li><strong>Test locally first</strong> - Run tests
                before pushing</li>
                <li><strong>Review secrets</strong> - Ensure no
                hardcoded passwords</li>
                </ol>
                <h2 id="future-enhancements">Future Enhancements</h2>
                <ol type="1">
                <li><strong>Multi-region deployment</strong> - Deploy to
                multiple Koyeb regions</li>
                <li><strong>Staged rollout</strong> - Blue-green
                deployment</li>
                <li><strong>Canary releases</strong> - Deploy to small
                percentage first</li>
                <li><strong>Performance testing</strong> - Run load
                tests pre-deployment</li>
                <li><strong>Slack notifications</strong> - Alert team on
                failures</li>
                <li><strong>Artifact retention</strong> - Keep previous
                deployments</li>
                <li><strong>Database migrations</strong> - Automated
                migration testing</li>
                <li><strong>Security scanning</strong> - SAST/DAST in
                pipeline</li>
                </ol>
                <hr />
                <p><strong>Document Version</strong>: 1.0<br />
                <strong>Last Updated</strong>: October 31, 2025<br />
                <strong>Status</strong>: Production Ready</p>
            </div>
        </main>
    </aside>

    <footer>
        <div class="footer-content">
            <p><strong>StockEase</strong> - Inventory Management System</p>
            <p>Architecture Documentation | Generated with Enterprise Standards</p>
            <p style="opacity: 0.7; font-size: 0.85rem;">Â© 2025 Team StockEase. All rights reserved.</p>
        </div>
    </footer>

    <script>
        // Navigation Menu
        const navigation = {
            'API Documentation': [
                { label: 'Overview', href: '/stockease/api/' },
            ],
            'Architecture': [
                { label: 'Overview', href: './overview.html' },
                { label: 'System Layers', href: './layers.html' },
                { label: 'Backend Architecture', href: './backend.html' },
                { label: 'Frontend Architecture', href: './frontend.html' },
                { label: 'Security Architecture', href: './security.html' },
                { label: 'Deployment Strategy', href: './deployment.html' },
            ],
            'Design Decisions': [
                { label: 'Index', href: './decisions/index.html' },
            ],
            'Components': [
                { label: 'Index', href: './components/index.html' },
            ],
            'Patterns': [
                { label: 'Index', href: './patterns/index.html' },
            ],
            'Testing': [
                { label: 'Architecture', href: './testing-architecture.html' },
                { label: 'Security Tests', href: './testing/security-tests.html' },
                { label: 'Test Pyramid', href: './testing/pyramid.html' },
                { label: 'Test Strategy', href: './testing/strategy.html' },
            ],
            'Deployment': [
                { label: 'CI/CD Pipeline', href: './deployment/ci-pipeline.html' },
                { label: 'Docker Strategy', href: './deployment/docker-strategy.html' },
            ],
            'Reference': [
                { label: 'Navigation Map', href: './NAVIGATION-MAP.html' },
                { label: 'Cross References', href: './CROSS-REFERENCE.html' },
                { label: 'Documentation Index', href: './DOCUMENTATION-INDEX.html' },
            ],
        };

        // Build sidebar
        function buildSidebar() {
            const sidebar = document.getElementById('sidebar');
            if (!sidebar) return;

            Object.entries(navigation).forEach(([section, links]) => {
                const navSection = document.createElement('div');
                navSection.className = 'nav-section';

                const title = document.createElement('div');
                title.className = 'nav-section-title';
                title.textContent = section;
                navSection.appendChild(title);

                const ul = document.createElement('ul');
                links.forEach(link => {
                    const li = document.createElement('li');
                    const a = document.createElement('a');
                    a.href = link.href;
                    a.textContent = link.label;

                    // Highlight current page
                    const currentPath = window.location.pathname;
                    if (currentPath.includes(link.href.replace('./', '').replace('.html', ''))) {
                        a.className = 'active';
                    }

                    li.appendChild(a);
                    ul.appendChild(li);
                });

                navSection.appendChild(ul);
                sidebar.appendChild(navSection);
            });
        }

        // Build table of contents highlight
        function initTableOfContents() {
            const tocLinks = document.querySelectorAll('nav.toc a');
            const headings = document.querySelectorAll('h2, h3');

            window.addEventListener('scroll', () => {
                let currentHeading = null;
                headings.forEach(heading => {
                    if (heading.getBoundingClientRect().top <= 100) {
                        currentHeading = heading;
                    }
                });

                tocLinks.forEach(link => {
                    link.classList.remove('active');
                    if (currentHeading) {
                        const href = link.getAttribute('href');
                        if (href === '#' + currentHeading.id) {
                            link.classList.add('active');
                        }
                    }
                });
            });
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            buildSidebar();
            initTableOfContents();
        });
    </script>
</body>
</html>
