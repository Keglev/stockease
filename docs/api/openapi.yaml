openapi: 3.0.3
info:
  title: StockEase API
  version: 1.0.0
  description: |
    StockEase API provides comprehensive inventory management capabilities including product CRUD operations, 
    JWT-based authentication, pagination, search, and stock analytics. All endpoints except login and health check 
    require valid JWT authentication with USER or ADMIN roles.
  contact:
    name: Team StockEase
    email: support@stockease.com
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT

servers:
  - url: http://localhost:8080
    description: Local development environment
  - url: https://api.stockease.com
    description: Production environment

tags:
  - name: Authentication
    description: User authentication and JWT token management
  - name: Products
    description: Product inventory management, CRUD operations, pagination, and analytics
  - name: Health
    description: Application health check and database connectivity monitoring

components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: |
        JWT token for authentication. Obtained from /api/auth/login endpoint.
        Include in Authorization header: "Authorization: Bearer <token>"
        Tokens contain user role (ADMIN or USER) as claim.
  
  schemas:
    # Authentication DTOs
    LoginRequest:
      type: object
      required:
        - username
        - password
      properties:
        username:
          type: string
          minLength: 1
          description: User account name (must not be blank)
          example: admin
        password:
          type: string
          minLength: 1
          description: User account password (must not be blank)
          example: password123
      description: Credentials for user authentication

    ApiResponse:
      type: object
      required:
        - success
        - message
      properties:
        success:
          type: boolean
          description: Operation success indicator
          example: true
        message:
          type: string
          description: Human-readable outcome message
          example: Login successful
        data:
          type: object
          nullable: true
          description: Operation result payload (null for error responses)
      description: Standard wrapper for all API responses

    ApiResponseString:
      allOf:
        - $ref: '#/components/schemas/ApiResponse'
        - type: object
          properties:
            data:
              type: string
              example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...

    # Product DTOs
    Product:
      type: object
      required:
        - id
        - name
        - quantity
        - price
        - totalValue
      properties:
        id:
          type: integer
          format: int64
          description: Unique product identifier (auto-generated)
          example: 1
        name:
          type: string
          minLength: 1
          description: Product name (unique in database)
          example: Laptop
        quantity:
          type: integer
          minimum: 0
          description: Current stock quantity (cannot be negative)
          example: 50
        price:
          type: number
          format: double
          minimum: 0.01
          description: Unit price (must be positive)
          example: 999.99
        totalValue:
          type: number
          format: double
          description: Total inventory value (auto-calculated as quantity * price)
          example: 49999.50
      description: Product inventory item with stock and pricing information

    ApiResponseProduct:
      allOf:
        - $ref: '#/components/schemas/ApiResponse'
        - type: object
          properties:
            data:
              $ref: '#/components/schemas/Product'

    ProductList:
      type: array
      items:
        $ref: '#/components/schemas/Product'
      description: List of products

    ApiResponseProductList:
      allOf:
        - $ref: '#/components/schemas/ApiResponse'
        - type: object
          properties:
            data:
              $ref: '#/components/schemas/ProductList'

    PaginatedResponse:
      type: object
      required:
        - content
        - totalElements
        - totalPages
        - currentPage
        - pageSize
      properties:
        content:
          type: array
          items:
            $ref: '#/components/schemas/Product'
          description: Products for current page
        totalElements:
          type: integer
          format: int64
          description: Total number of products across all pages
          example: 100
        totalPages:
          type: integer
          description: Total number of available pages
          example: 10
        currentPage:
          type: integer
          description: Zero-based current page number
          example: 0
        pageSize:
          type: integer
          description: Number of items per page
          example: 10
      description: Paginated product response with metadata

    ApiResponsePaginated:
      allOf:
        - $ref: '#/components/schemas/ApiResponse'
        - type: object
          properties:
            data:
              $ref: '#/components/schemas/PaginatedResponse'

    # Error Responses
    ErrorResponse:
      type: object
      required:
        - error
      properties:
        error:
          type: string
          description: Error message describing what went wrong
          example: Incomplete update. Please fill in all required fields.

    ApiResponseError:
      type: object
      required:
        - success
        - message
      properties:
        success:
          type: boolean
          example: false
        message:
          type: string
          example: Operation failed
        data:
          nullable: true

paths:
  /api/auth/login:
    $ref: './paths/auth-login.yaml'
  
  /api/products:
    $ref: './paths/products.yaml'
  
  /api/products/{id}:
    $ref: './paths/products-detail.yaml'
  
  /api/products/paged:
    $ref: './paths/products-paged.yaml'
  
  /api/products/low-stock:
    $ref: './paths/products-low-stock.yaml'
  
  /api/products/search:
    $ref: './paths/products-search.yaml'
  
  /api/products/{id}/quantity:
    $ref: './paths/products-quantity.yaml'
  
  /api/products/{id}/price:
    $ref: './paths/products-price.yaml'
  
  /api/products/{id}/name:
    $ref: './paths/products-name.yaml'
  
  /api/products/total-stock-value:
    $ref: './paths/products-total-stock-value.yaml'
  
  /api/health:
    $ref: './paths/health.yaml'

security:
  - BearerAuth: []

