<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>deployment</title>
  <style>
    html {
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 12px;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      html {
        background-color: white;
      }
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, Consolas, 'Lucida Console', monospace;
      font-size: 85%;
      margin: 0;
      hyphens: manual;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
</head>
<body>
<nav id="TOC" role="doc-toc">
<ul>
<li><a href="#deployment-infrastructure-architecture"
id="toc-deployment-infrastructure-architecture">Deployment &amp;
Infrastructure Architecture</a>
<ul>
<li><a href="#deployment-topology"
id="toc-deployment-topology">Deployment Topology</a></li>
<li><a href="#cicd-pipeline-details"
id="toc-cicd-pipeline-details">CI/CD Pipeline Details</a>
<ul>
<li><a href="#build-deploy-workflow-auto_deploy.yml"
id="toc-build-deploy-workflow-auto_deploy.yml">Build &amp; Deploy
Workflow (<code>auto_deploy.yml</code>)</a></li>
<li><a href="#documentation-pipeline-docs-ci.yml---to-be-created"
id="toc-documentation-pipeline-docs-ci.yml---to-be-created">Documentation
Pipeline (<code>docs-ci.yml</code> - TO BE CREATED)</a></li>
</ul></li>
<li><a href="#deployment-environments"
id="toc-deployment-environments">Deployment Environments</a>
<ul>
<li><a href="#development-environment"
id="toc-development-environment">Development Environment</a></li>
<li><a href="#staging-environment" id="toc-staging-environment">Staging
Environment</a></li>
<li><a href="#production-environment"
id="toc-production-environment">Production Environment</a></li>
</ul></li>
<li><a href="#koyeb-deployment-configuration"
id="toc-koyeb-deployment-configuration">Koyeb Deployment
Configuration</a>
<ul>
<li><a href="#service-details" id="toc-service-details">Service
Details</a></li>
<li><a href="#auto-scaling-configuration"
id="toc-auto-scaling-configuration">Auto-Scaling Configuration</a></li>
</ul></li>
<li><a href="#database-management-neon-postgresql"
id="toc-database-management-neon-postgresql">Database Management (Neon
PostgreSQL)</a>
<ul>
<li><a href="#connection-details" id="toc-connection-details">Connection
Details</a></li>
<li><a href="#automated-backups" id="toc-automated-backups">Automated
Backups</a></li>
<li><a href="#database-migrations-flyway"
id="toc-database-migrations-flyway">Database Migrations
(Flyway)</a></li>
</ul></li>
<li><a href="#containerization"
id="toc-containerization">Containerization</a>
<ul>
<li><a href="#dockerfile" id="toc-dockerfile">Dockerfile</a></li>
<li><a href="#image-registry-ghcr" id="toc-image-registry-ghcr">Image
Registry (GHCR)</a></li>
</ul></li>
<li><a href="#monitoring-observability"
id="toc-monitoring-observability">Monitoring &amp; Observability</a>
<ul>
<li><a href="#health-checks" id="toc-health-checks">Health
Checks</a></li>
<li><a href="#application-logs" id="toc-application-logs">Application
Logs</a></li>
<li><a href="#metrics-monitoring" id="toc-metrics-monitoring">Metrics
Monitoring</a></li>
</ul></li>
<li><a href="#disaster-recovery" id="toc-disaster-recovery">Disaster
Recovery</a>
<ul>
<li><a href="#backup-strategy" id="toc-backup-strategy">Backup
Strategy</a></li>
<li><a href="#recovery-procedures" id="toc-recovery-procedures">Recovery
Procedures</a></li>
</ul></li>
<li><a href="#performance-tuning"
id="toc-performance-tuning">Performance Tuning</a>
<ul>
<li><a href="#jvm-configuration" id="toc-jvm-configuration">JVM
Configuration</a></li>
<li><a href="#database-optimization"
id="toc-database-optimization">Database Optimization</a></li>
<li><a href="#caching-future" id="toc-caching-future">Caching
(Future)</a></li>
</ul></li>
<li><a href="#security-in-deployment"
id="toc-security-in-deployment">Security in Deployment</a>
<ul>
<li><a href="#secrets-management" id="toc-secrets-management">Secrets
Management</a></li>
<li><a href="#network-security" id="toc-network-security">Network
Security</a></li>
<li><a href="#image-security" id="toc-image-security">Image
Security</a></li>
</ul></li>
<li><a href="#deployment-checklist"
id="toc-deployment-checklist">Deployment Checklist</a></li>
<li><a href="#related-documentation"
id="toc-related-documentation">Related Documentation</a>
<ul>
<li><a href="#main-architecture-topics"
id="toc-main-architecture-topics">Main Architecture Topics</a></li>
<li><a href="#architecture-decisions-adrs"
id="toc-architecture-decisions-adrs">Architecture Decisions
(ADRs)</a></li>
<li><a href="#design-patterns-practices"
id="toc-design-patterns-practices">Design Patterns &amp;
Practices</a></li>
<li><a href="#deployment-details" id="toc-deployment-details">Deployment
Details</a></li>
<li><a href="#related-frontend-docs"
id="toc-related-frontend-docs">Related Frontend Docs</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
<h1 id="deployment-infrastructure-architecture">Deployment &amp;
Infrastructure Architecture</h1>
<h2 id="deployment-topology">Deployment Topology</h2>
<pre><code>┌────────────────────────────────────────────────────────────────────┐
│                         GitHub Repository                          │
│                    (Keglev/stockease)                              │
│  ┌─────────────────┐  ┌──────────────────────┐  ┌──────────────┐ │
│  │  main branch    │  │  docs branch (GH     │  │ Pull Requests│ │
│  │  (Source Code)  │  │  Pages output)       │  │ (Reviews)    │ │
│  └────────┬────────┘  └──────────────────────┘  └──────────────┘ │
└───────────┼─────────────────────────────────────────────────────────┘
            │
            │ Push to origin/main
            ↓
┌────────────────────────────────────────────────────────────────────┐
│               GitHub Actions (CI/CD Pipelines)                     │
│  ┌─────────────────────────┐      ┌──────────────────────────────┐ │
│  │  Build &amp; Test Workflow  │      │  Docs Generation Workflow   │ │
│  │  (auto_deploy.yml)      │      │  (docs-ci.yml)              │ │
│  │                         │      │                              │ │
│  │  1. Checkout code       │      │  1. Extract OpenAPI spec    │ │
│  │  2. Run Maven build     │      │  2. Convert Markdown → HTML │ │
│  │  3. Run tests (65+)     │      │  3. Generate Redoc HTML     │ │
│  │  4. Build Docker image  │      │  4. Collect coverage        │ │
│  │  5. Push to GHCR        │      │  5. Commit to docs branch   │ │
│  │  6. Deploy to Koyeb     │      │  6. GitHub Pages auto-sync  │ │
│  └─────────────────────────┘      └──────────────────────────────┘ │
└────────────┬───────────────────────────┬──────────────────────────────┘
             │                           │
             │ GHCR Image                │ Generated HTML
             │ ghcr.io/keglev/...        │ docs branch
             ↓                           ↓
      ┌─────────────────┐         ┌──────────────────┐
      │   Koyeb         │         │   GitHub Pages   │
      │   Container     │         │   (docs branch)  │
      │   Service       │         │                  │
      │   (Production)  │         │ https://Keglev...│
      └────────┬────────┘         └──────────────────┘
               │
               │ JDBC Connection
               ↓
      ┌─────────────────────────┐
      │  Neon PostgreSQL 17.5   │
      │  (Serverless Database)  │
      │  - Auto-backups         │
      │  - Connection pooling   │
      │  - Failover support     │
      └─────────────────────────┘</code></pre>
<h2 id="cicd-pipeline-details">CI/CD Pipeline Details</h2>
<h3 id="build-deploy-workflow-auto_deploy.yml">Build &amp; Deploy
Workflow (<code>auto_deploy.yml</code>)</h3>
<p><strong>Trigger Events</strong>: - Push to <code>main</code> branch -
Pull request creation - Manual trigger (workflow_dispatch)</p>
<p><strong>Pipeline Stages</strong>:</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Stage 1</span><span class="kw">:</span><span class="at"> Checkout &amp; Setup</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="at">  ├── Checkout code from GitHub</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="at">  ├── Set up JDK 17</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="at">  ├── Cache Maven dependencies</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="at">  └── Verify build environment</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="fu">Stage 2</span><span class="kw">:</span><span class="at"> Build</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="at">  ├── Run Maven clean package</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="at">  ├── Compile all Java source code</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="at">  ├── Skip tests in this stage (to save time)</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="at">  └── Generate JAR file</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="fu">Stage 3</span><span class="kw">:</span><span class="at"> Test</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="at">  ├── Run 65+ unit tests</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="at">  ├── Tests use H2 in-memory database</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="at">  ├── Generate coverage reports (JaCoCo)</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="at">  └── Fail pipeline if tests don&#39;t pass</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="fu">Stage 4</span><span class="kw">:</span><span class="at"> Build Docker Image</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="at">  ├── Read Dockerfile from repository</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="at">  ├── Build image based on Dockerfile</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">├── Tag</span><span class="kw">:</span><span class="at"> ghcr.io/keglev/stockease:latest</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">├── Tag</span><span class="kw">:</span><span class="at"> ghcr.io/keglev/stockease:{commit-sha}</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a><span class="at">  └── Generate SBOM (Software Bill of Materials)</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a><span class="fu">Stage 5</span><span class="kw">:</span><span class="at"> Push to Container Registry</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a><span class="at">  ├── Authenticate with GHCR (GitHub Container Registry)</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a><span class="at">  ├── Push tagged images to GHCR</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a><span class="at">  ├── Make images available for deployment</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">└── Store in</span><span class="kw">:</span><span class="at"> ghcr.io/keglev/stockease:*</span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a><span class="fu">Stage 6</span><span class="kw">:</span><span class="at"> Deploy to Koyeb</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a><span class="at">  ├── Get Koyeb API token from secrets</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a><span class="at">  ├── Trigger Koyeb deployment</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a><span class="at">  ├── Pull latest image from GHCR</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a><span class="at">  ├── Perform blue-green deployment</span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a><span class="at">  ├── Health checks (retry up to 5 times)</span></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a><span class="at">  └── Rollback if health check fails</span></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a><span class="fu">Stage 7</span><span class="kw">:</span><span class="at"> Verification</span></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a><span class="at">  ├── Verify deployment status</span></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">├── Check health endpoint</span><span class="kw">:</span><span class="at"> /health</span></span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a><span class="at">  ├── Log deployment results</span></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a><span class="at">  └── Notify on success/failure</span></span></code></pre></div>
<h3
id="documentation-pipeline-docs-ci.yml---to-be-created">Documentation
Pipeline (<code>docs-ci.yml</code> - TO BE CREATED)</h3>
<p><strong>Trigger Events</strong>: - Push to <code>main</code> when
<code>/backend/docs/</code> changes - Manual trigger</p>
<p><strong>Pipeline Stages</strong>:</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Stage 1</span><span class="kw">:</span><span class="at"> Extract OpenAPI Spec</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="at">  ├── Build backend application</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="at">  ├── Start Spring Boot server</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="at">  ├── Fetch OpenAPI spec from /v3/api-docs</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="at">  ├── Validate OpenAPI spec</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="at">  ├── Save to docs/api/openapi/openapi.json</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="fu">Stage 2</span><span class="kw">:</span><span class="at"> Generate Redoc HTML</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="at">  ├── Install Redoc CLI</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="at">  ├── Read OpenAPI spec</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="at">  ├── Generate interactive HTML documentation</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="at">  ├── Output to docs/api/redoc/index.html</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="at">  └── Optimize for web</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="fu">Stage 3</span><span class="kw">:</span><span class="at"> Convert Markdown to HTML</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="at">  ├── Install pandoc</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">├── For each .md file in docs/architecture/</span><span class="kw">:</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="at">  │   ├── Convert to HTML</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="at">  │   ├── Apply styling</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="at">  │   └── Output to docs/architecture/*.html</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="at">  ├── Convert docs/index.md to docs/index.html</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="at">  └── Generate table of contents</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="fu">Stage 4</span><span class="kw">:</span><span class="at"> Collect Coverage Reports</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="at">  ├── Run Maven test with JaCoCo</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="at">  ├── Generate coverage report</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a><span class="at">  ├── Copy to docs/coverage/</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a><span class="at">  ├── Generate index.html for coverage dashboard</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a><span class="at">  └── Calculate coverage percentage</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a><span class="fu">Stage 5</span><span class="kw">:</span><span class="at"> Commit to Docs Branch</span></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a><span class="at">  ├── Switch to docs branch</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a><span class="at">  ├── Remove old generated files</span></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a><span class="at">  ├── Copy all new HTML files</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">├── Commit</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;docs: auto-generated documentation&quot;</span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a><span class="at">  ├── Push to origin/docs</span></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a><span class="at">  └── GitHub Pages auto-publishes</span></span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a><span class="fu">Stage 6</span><span class="kw">:</span><span class="at"> Cleanup</span></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a><span class="at">  ├── Remove temporary files</span></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a><span class="at">  ├── Clean build artifacts</span></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a><span class="at">  └── Log completion</span></span></code></pre></div>
<h2 id="deployment-environments">Deployment Environments</h2>
<h3 id="development-environment">Development Environment</h3>
<ul>
<li><strong>Branch</strong>: Any feature branch</li>
<li><strong>Triggered By</strong>: Manual trigger or PR</li>
<li><strong>Database</strong>: H2 in-memory (testing only)</li>
<li><strong>Deployment</strong>: Skipped</li>
<li><strong>Testing</strong>: Full suite (65+ tests)</li>
</ul>
<h3 id="staging-environment">Staging Environment</h3>
<ul>
<li><strong>Branch</strong>: develop (if used)</li>
<li><strong>Deployment Target</strong>: Separate Koyeb service</li>
<li><strong>Database</strong>: PostgreSQL test instance</li>
<li><strong>Testing</strong>: Full test suite + smoke tests</li>
<li><strong>Duration</strong>: 10-15 minutes</li>
</ul>
<h3 id="production-environment">Production Environment</h3>
<ul>
<li><strong>Branch</strong>: main</li>
<li><strong>Deployment Target</strong>: Koyeb production service</li>
<li><strong>Database</strong>: Neon PostgreSQL (production)</li>
<li><strong>URL</strong>:
https://stockease-backend-production.koyeb.app</li>
<li><strong>Testing</strong>: Full test suite + health checks</li>
<li><strong>Duration</strong>: 3-5 minutes</li>
<li><strong>Rollback</strong>: Automatic if health checks fail</li>
</ul>
<h2 id="koyeb-deployment-configuration">Koyeb Deployment
Configuration</h2>
<h3 id="service-details">Service Details</h3>
<div class="sourceCode" id="cb4"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Service Name</span><span class="kw">:</span><span class="at"> stockease-backend-production</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Status</span><span class="kw">:</span><span class="at"> HEALTHY</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">Runtime</span><span class="kw">:</span><span class="at"> Docker (custom image)</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">Region</span><span class="kw">:</span><span class="at"> US (Auto)</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">Replicas</span><span class="kw">:</span><span class="at"> 1-2 (auto-scaling)</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="fu">Domain</span><span class="kw">:</span><span class="at"> stockease-backend-production.koyeb.app</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="fu">Environment Variables</span><span class="kw">:</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">SPRING_PROFILES_ACTIVE</span><span class="kw">:</span><span class="at"> production</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">DB_HOST</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">Neon endpoint</span><span class="kw">]</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">DB_PORT</span><span class="kw">:</span><span class="at"> </span><span class="dv">5432</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">DB_NAME</span><span class="kw">:</span><span class="at"> stockease</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">DB_USER</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">from secrets</span><span class="kw">]</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">DB_PASSWORD</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">from secrets</span><span class="kw">]</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">JWT_SECRET</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">from secrets</span><span class="kw">]</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">JAVA_OPTS</span><span class="kw">:</span><span class="at"> -Xmx512m -Xms256m</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="fu">Port Mapping</span><span class="kw">:</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">Container Port</span><span class="kw">:</span><span class="at"> </span><span class="dv">8080</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">Public Port</span><span class="kw">:</span><span class="at"> 443 (HTTPS)</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">Protocol</span><span class="kw">:</span><span class="at"> HTTP2</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a><span class="fu">Health Check</span><span class="kw">:</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">Endpoint</span><span class="kw">:</span><span class="at"> /health</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">Interval</span><span class="kw">:</span><span class="at"> 30 seconds</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">Timeout</span><span class="kw">:</span><span class="at"> 5 seconds</span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">Consecutive Failures</span><span class="kw">:</span><span class="at"> </span><span class="dv">3</span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">Consecutive Successes</span><span class="kw">:</span><span class="at"> </span><span class="dv">1</span></span></code></pre></div>
<h3 id="auto-scaling-configuration">Auto-Scaling Configuration</h3>
<div class="sourceCode" id="cb5"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Min Replicas</span><span class="kw">:</span><span class="at"> </span><span class="dv">1</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Max Replicas</span><span class="kw">:</span><span class="at"> </span><span class="dv">2</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">Target CPU</span><span class="kw">:</span><span class="at"> 70%</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">Target Memory</span><span class="kw">:</span><span class="at"> 80%</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">Scale Up Delay</span><span class="kw">:</span><span class="at"> 60 seconds</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="fu">Scale Down Delay</span><span class="kw">:</span><span class="at"> 300 seconds</span></span></code></pre></div>
<h2 id="database-management-neon-postgresql">Database Management (Neon
PostgreSQL)</h2>
<h3 id="connection-details">Connection Details</h3>
<pre><code>Host: [neon-project].neon.tech
Port: 5432
Database: stockease
SSL Mode: require
Connection Pooling: Enabled (connection limit: 100)</code></pre>
<h3 id="automated-backups">Automated Backups</h3>
<ul>
<li><strong>Frequency</strong>: Automatic daily</li>
<li><strong>Retention</strong>: 7 days</li>
<li><strong>Backup Type</strong>: Full backup</li>
<li><strong>Recovery</strong>: Point-in-time restore available</li>
</ul>
<h3 id="database-migrations-flyway">Database Migrations (Flyway)</h3>
<p><strong>Migration Files</strong> (in
<code>src/main/resources/db/migration/</code>):</p>
<pre><code>V1__init_schema.sql
  ├── CREATE TABLE users
  │   ├── id (UUID, PK)
  │   ├── username (VARCHAR, UNIQUE)
  │   ├── password (VARCHAR, BCrypt)
  │   ├── role (VARCHAR)
  │   ├── created_at (TIMESTAMP)
  │   └── updated_at (TIMESTAMP)
  │
  └── CREATE TABLE products
      ├── id (UUID, PK)
      ├── name (VARCHAR)
      ├── description (TEXT)
      ├── price (DECIMAL)
      ├── quantity (INTEGER)
      ├── sku (VARCHAR, UNIQUE)
      ├── category (VARCHAR)
      ├── created_at (TIMESTAMP)
      ├── updated_at (TIMESTAMP)
      └── created_by (UUID, FK → users)

V2__add_indexes.sql
  ├── CREATE INDEX idx_products_sku
  ├── CREATE INDEX idx_products_category
  ├── CREATE INDEX idx_users_username
  └── CREATE INDEX idx_products_created_by

V3__seed_data.sql
  ├── INSERT admin user (admin/admin123)
  ├── INSERT regular user (user/user123)
  ├── INSERT sample products
  └── Uses DB-agnostic existence check for H2 compatibility</code></pre>
<p><strong>Migration Execution</strong>:</p>
<pre><code>Application Startup
  ├── Spring Boot loads
  ├── Flyway initializes
  ├── Checks flyway_schema_history table
  ├── Identifies new migrations
  ├── Executes migrations in order
  ├── Updates schema version
  └── Application proceeds with data access</code></pre>
<h2 id="containerization">Containerization</h2>
<h3 id="dockerfile">Dockerfile</h3>
<div class="sourceCode" id="cb9"><pre
class="sourceCode dockerfile"><code class="sourceCode dockerfile"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Multi-stage build for optimization</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> eclipse-temurin:17-jdk-alpine <span class="kw">AS</span> builder</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="kw">WORKDIR</span> /app</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="kw">COPY</span> mvnw .</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="kw">COPY</span> pom.xml .</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="kw">COPY</span> src src</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Build application</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="kw">RUN</span> <span class="ex">./mvnw</span> clean package <span class="at">-DskipTests</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Runtime stage</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> eclipse-temurin:17-jre-alpine</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="kw">WORKDIR</span> /app</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Copy JAR from builder</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="kw">COPY</span> <span class="op">--from=builder</span> /app/target/stockease-backend-*.jar app.jar</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Health check</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="kw">HEALTHCHECK</span> <span class="op">--interval=30s</span> <span class="op">--timeout=5s</span> <span class="op">--start-period=10s</span> <span class="op">--retries=3</span> \</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">CMD</span> <span class="fu">wget</span> <span class="at">--no-verbose</span> <span class="at">--tries</span><span class="op">=</span>1 <span class="at">--spider</span> http://localhost:8080/health <span class="kw">||</span> <span class="bu">exit</span> 1</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Expose port</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a><span class="kw">EXPOSE</span> 8080</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Run application</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a><span class="kw">ENTRYPOINT</span> [<span class="st">&quot;java&quot;</span>, <span class="st">&quot;-jar&quot;</span>, <span class="st">&quot;app.jar&quot;</span>]</span></code></pre></div>
<p><strong>Image Details</strong>: - <strong>Base Image</strong>:
eclipse-temurin:17-jre-alpine (122MB) - <strong>Final Size</strong>:
~350MB (with JAR and dependencies) - <strong>Build Time</strong>: ~2
minutes - <strong>Startup Time</strong>: ~8-10 seconds</p>
<h3 id="image-registry-ghcr">Image Registry (GHCR)</h3>
<pre><code>Registry: ghcr.io/keglev/stockease
Authentication: GitHub PAT (Personal Access Token)

Image Tags:
  - ghcr.io/keglev/stockease:latest (always latest build)
  - ghcr.io/keglev/stockease:v1.0.0 (semantic versioning)
  - ghcr.io/keglev/stockease:sha-abc123 (commit hash)</code></pre>
<h2 id="monitoring-observability">Monitoring &amp; Observability</h2>
<h3 id="health-checks">Health Checks</h3>
<p><strong>Endpoint</strong>: <code>GET /health</code></p>
<p><strong>Response</strong> (when healthy):</p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;status&quot;</span><span class="fu">:</span> <span class="st">&quot;UP&quot;</span><span class="fu">,</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;components&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;db&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;status&quot;</span><span class="fu">:</span> <span class="st">&quot;UP&quot;</span><span class="fu">,</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;details&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;database&quot;</span><span class="fu">:</span> <span class="st">&quot;PostgreSQL&quot;</span><span class="fu">,</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;validationQuery&quot;</span><span class="fu">:</span> <span class="st">&quot;isValid()&quot;</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">}</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">},</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;diskSpace&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;status&quot;</span><span class="fu">:</span> <span class="st">&quot;UP&quot;</span><span class="fu">,</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;details&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;total&quot;</span><span class="fu">:</span> <span class="dv">10737418240</span><span class="fu">,</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;free&quot;</span><span class="fu">:</span> <span class="dv">5368709120</span><span class="fu">,</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;threshold&quot;</span><span class="fu">:</span> <span class="dv">10485760</span><span class="fu">,</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;exists&quot;</span><span class="fu">:</span> <span class="kw">true</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">}</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">}</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
<p><strong>Response</strong> (when unhealthy):</p>
<div class="sourceCode" id="cb12"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;status&quot;</span><span class="fu">:</span> <span class="st">&quot;DOWN&quot;</span><span class="fu">,</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;components&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;db&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;status&quot;</span><span class="fu">:</span> <span class="st">&quot;DOWN&quot;</span><span class="fu">,</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;details&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;error&quot;</span><span class="fu">:</span> <span class="st">&quot;Connection refused&quot;</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">}</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">}</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
<h3 id="application-logs">Application Logs</h3>
<p><strong>Log Output</strong> (captured by Koyeb):</p>
<pre><code>[2025-10-31 10:30:00] INFO  o.s.b.StartupInfoLogger : Starting StockEaseApplication
[2025-10-31 10:30:01] INFO  o.s.d.r.c.EnableJpaRepositoriesRegistrar : Scanning JPA repositories
[2025-10-31 10:30:02] INFO  o.f.c.internal.license.VersionPrinter : Flyway Community Edition
[2025-10-31 10:30:02] INFO  o.f.c.internal.database.base.DatabaseFactory : Database: PostgreSQL 17.5
[2025-10-31 10:30:02] INFO  o.f.c.i.s.sql.PlaceholderReplacer : Locations: [classpath:db/migration]
[2025-10-31 10:30:02] INFO  o.f.c.i.c.sql.SqlScriptExecutor : Successfully validated 3 migrations
[2025-10-31 10:30:02] INFO  o.f.c.i.c.sql.SqlScriptExecutor : Current version of schema &quot;public&quot;: 3
[2025-10-31 10:30:03] INFO  o.s.s.web.DefaultSecurityFilterChain : Will secure any request
[2025-10-31 10:30:03] INFO  o.s.b.w.e.tomcat.TomcatWebServer : Tomcat started on port(s): 8080
[2025-10-31 10:30:04] INFO  o.s.b.StartupInfoLogger : Started StockEaseApplication in 4.123s</code></pre>
<h3 id="metrics-monitoring">Metrics Monitoring</h3>
<p><strong>Tracked Metrics</strong>: - <strong>Request Count</strong>:
Requests per minute - <strong>Response Time</strong>: Average, P50, P95,
P99 - <strong>Error Rate</strong>: 4xx, 5xx errors - <strong>Database
Connections</strong>: Active, idle, queued - <strong>Memory
Usage</strong>: Heap, non-heap - <strong>CPU Usage</strong>: Container
CPU %</p>
<p><strong>Alerts</strong> (future): - Health check failures (trigger
rollback) - High error rate (&gt;5%) - Slow response times (&gt;500ms
avg) - Memory pressure (&gt;85%) - Database connection pool
exhaustion</p>
<h2 id="disaster-recovery">Disaster Recovery</h2>
<h3 id="backup-strategy">Backup Strategy</h3>
<ul>
<li><strong>Database</strong>: Automated daily backups (Neon)</li>
<li><strong>Code</strong>: Git repository with full history</li>
<li><strong>Configuration</strong>: Environment variables in GitHub
Secrets</li>
<li><strong>Docker Images</strong>: Retained in GHCR</li>
</ul>
<h3 id="recovery-procedures">Recovery Procedures</h3>
<p><strong>If Deployment Fails</strong>: 1. CI pipeline detects failure
2. Health checks fail 3. Koyeb automatically rolls back to previous
version 4. Notification sent to team 5. Review logs for root cause</p>
<p><strong>If Database is Corrupted</strong>: 1. Determine recovery
point from backups 2. Create database restore job 3. Test restore in
staging environment 4. Point Koyeb to restored database 5. Verify
application functionality</p>
<p><strong>If Koyeb Service Goes Down</strong>: 1. Manual trigger of
deployment pipeline 2. Redeploy from latest commit 3. Verify health
checks pass 4. Monitor for stability</p>
<h2 id="performance-tuning">Performance Tuning</h2>
<h3 id="jvm-configuration">JVM Configuration</h3>
<pre><code>-Xmx512m          # Max heap: 512MB
-Xms256m          # Initial heap: 256MB
-XX:+UseG1GC      # G1 garbage collection
-XX:MaxGCPauseMillis=200</code></pre>
<h3 id="database-optimization">Database Optimization</h3>
<pre><code>Connection Pool: HikariCP
Max Connections: 10
Idle Timeout: 600 seconds
Connection Timeout: 30 seconds</code></pre>
<h3 id="caching-future">Caching (Future)</h3>
<ul>
<li>Spring Cache abstraction</li>
<li>Redis for session/data caching</li>
<li>TTL: 1 hour for product data</li>
</ul>
<h2 id="security-in-deployment">Security in Deployment</h2>
<h3 id="secrets-management">Secrets Management</h3>
<pre><code>Environment Variables (GitHub Secrets):
  - DB_PASSWORD
  - JWT_SECRET
  - GITHUB_TOKEN (for deployments)</code></pre>
<p><strong>Never Committed to Repository</strong>: - Database passwords
- API keys - JWT secrets - Personal access tokens</p>
<h3 id="network-security">Network Security</h3>
<ul>
<li>HTTPS/TLS enforced</li>
<li>CORS configured for frontend domain only</li>
<li>WAF rules (via Koyeb/CloudFlare)</li>
<li>DDoS protection enabled</li>
</ul>
<h3 id="image-security">Image Security</h3>
<ul>
<li>No hardcoded secrets in Docker image</li>
<li>Alpine Linux for minimal attack surface</li>
<li>Regular base image updates</li>
<li>SBOM (Software Bill of Materials) generated</li>
</ul>
<h2 id="deployment-checklist">Deployment Checklist</h2>
<p>Before production deployment: - [ ] All tests passing (65+) - [ ]
Code reviewed - [ ] Secrets configured in GitHub - [ ] Database
migrations validated - [ ] Docker image built and tested - [ ] Health
checks verified - [ ] CORS configured correctly - [ ] SSL certificates
valid - [ ] Backups configured - [ ] Monitoring/alerting set up - [ ]
Documentation updated - [ ] Rollback plan prepared</p>
<hr />
<h2 id="related-documentation">Related Documentation</h2>
<h3 id="main-architecture-topics">Main Architecture Topics</h3>
<ul>
<li><strong><a href="./overview.md">Architecture Overview</a></strong> -
Business context and infrastructure decisions</li>
<li><strong><a href="./backend.md">Backend Architecture</a></strong> -
Application structure being deployed</li>
<li><strong><a href="./layers.md">Service Layers</a></strong> -
Layer-level considerations for deployment</li>
<li><strong><a href="./security.md">Security Architecture</a></strong> -
Security requirements for production deployment</li>
</ul>
<h3 id="architecture-decisions-adrs">Architecture Decisions (ADRs)</h3>
<ul>
<li><strong><a href="./decisions/001-database-choice.md">Database
Choice</a></strong> - PostgreSQL for production, H2 for testing</li>
<li><strong><a href="./decisions/002-validation-strategy.md">Validation
Strategy</a></strong> - Validation in pre-production testing</li>
</ul>
<h3 id="design-patterns-practices">Design Patterns &amp; Practices</h3>
<ul>
<li><strong><a href="./patterns/security-patterns.md">Security
Patterns</a></strong> - HTTPS/TLS, encryption, secure configuration</li>
<li><strong><a href="./patterns/repository-pattern.md">Repository
Pattern</a></strong> - Database connection strategies for
production</li>
</ul>
<h3 id="deployment-details">Deployment Details</h3>
<ul>
<li><strong><a href="./deployment/ci-pipeline.md">CI/CD
Pipeline</a></strong> - GitHub Actions for automated deployments</li>
<li><strong><a href="./deployment/staging-config.md">Staging
Configuration</a></strong> - Pre-production testing and
verification</li>
</ul>
<h3 id="related-frontend-docs">Related Frontend Docs</h3>
<ul>
<li><strong><a href="./frontend.md">Frontend Architecture</a></strong> -
React deployment to Render</li>
</ul>
<hr />
<p><strong>Document Version</strong>: 1.0<br />
<strong>Last Updated</strong>: October 31, 2025<br />
<strong>Status</strong>: Production Ready</p>
</body>
</html>
